<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Denoiser - AI-Powered Video Enhancement</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .drag-over {
            border-color: #3b82f6 !important;
            background-color: rgba(59, 130, 246, 0.1) !important;
        }
        
        .progress-bar {
            transition: width 0.3s ease;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Dark mode scrollbar */
        .dark ::-webkit-scrollbar-thumb {
            background: #555;
        }
        
        .dark ::-webkit-scrollbar-thumb:hover {
            background: #777;
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-200">
    <div id="root"></div>
    
    <script type="text/babel">
        // Global error handler for debugging
        window.addEventListener('error', (event) => {
            console.error('Error:', event.message);
        });
        
        const { useState, useEffect, useRef } = React;
        
        // Error Boundary Component
        class ErrorBoundary extends React.Component {
            constructor(props) {
                super(props);
                this.state = { hasError: false, error: null };
            }
            
            static getDerivedStateFromError(error) {
                return { hasError: true, error };
            }
            
            componentDidCatch(error, errorInfo) {
                console.error('React Error:', error, errorInfo);
            }
            
            render() {
                if (this.state.hasError) {
                    return (
                        <div style={{ padding: '20px', backgroundColor: '#fee', color: '#c00' }}>
                            <h1>Something went wrong!</h1>
                            <pre>{this.state.error?.toString()}</pre>
                            <button onClick={() => window.location.reload()}>Reload Page</button>
                        </div>
                    );
                }
                return this.props.children;
            }
        }
        
        // Main App Component
        function App() {
            const [darkMode, setDarkMode] = useState(false);
            const [selectedFile, setSelectedFile] = useState(null);
            const [jobId, setJobId] = useState(null);
            const [jobStatus, setJobStatus] = useState(null);
            const [processing, setProcessing] = useState(false);
            const [error, setError] = useState(null);
            const [videoInfo, setVideoInfo] = useState(null);
            const [settings, setSettings] = useState({
                clipSize: 2,
                numPasses: 2,
                useTemporal: true,
                modelName: 'baseline_sidd_width64'  // Default model
            });
            const [availableModels, setAvailableModels] = useState({});
            const [downloadingModel, setDownloadingModel] = useState(null);
            
            const fileInputRef = useRef(null);
            const pollIntervalRef = useRef(null);
            
            useEffect(() => {
                // Check system theme preference
                if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    setDarkMode(true);
                }
                
                // Load available models
                loadModels();
            }, []);
            
            // Icons are now unicode symbols - no initialization needed
            
            const loadModels = async () => {
                try {
                    const response = await fetch('/api/models');
                    if (response.ok) {
                        const models = await response.json();
                        setAvailableModels(models);
                        
                        // Auto-select first downloaded model if current selection not available
                        const downloadedModels = Object.entries(models).filter(([_, info]) => info.downloaded);
                        if (downloadedModels.length > 0) {
                            const currentModelDownloaded = models[settings.modelName]?.downloaded;
                            if (!currentModelDownloaded) {
                                // Select first downloaded model
                                const firstModel = downloadedModels[0][0];
                                setSettings(prev => ({...prev, modelName: firstModel}));
                                console.log('Auto-selected model:', firstModel);
                            }
                        }
                    }
                } catch (err) {
                    console.error('Failed to load models:', err);
                }
            };
            
            const downloadModel = async (modelName) => {
                try {
                    setDownloadingModel(modelName);
                    const response = await fetch(`/api/models/download/${modelName}`, {
                        method: 'POST'
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data.status === 'already_downloaded') {
                            alert('Model is already downloaded!');
                        } else {
                            alert(`Downloading ${modelName}... Check console for progress. Refresh page when done.`);
                        }
                        
                        // Reload models after a delay
                        setTimeout(loadModels, 3000);
                    }
                } catch (err) {
                    console.error('Download failed:', err);
                    alert('Failed to download model: ' + err.message);
                } finally {
                    setDownloadingModel(null);
                }
            };
            
            useEffect(() => {
                if (darkMode) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            }, [darkMode]);
            
            useEffect(() => {
                // Re-create icons when dark mode changes
                setTimeout(() => {
                    if (window.lucide) {
                        lucide.createIcons();
                    }
                }, 100);
            }, [darkMode, jobStatus, selectedFile]);
            
            const handleFileSelect = async (file) => {
                if (!file) return;
                
                // Validate file type
                if (!file.type.startsWith('video/')) {
                    setError('Please select a valid video file');
                    return;
                }
                
                setSelectedFile(file);
                setError(null);
                setJobStatus(null);
                
                // Upload file
                await uploadFile(file);
            };
            
            const uploadFile = async (file) => {
                try {
                    console.log('Starting upload:', file.name);
                    setProcessing(true);
                    const formData = new FormData();
                    formData.append('file', file);
                    
                    const response = await fetch('/api/upload', {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`Upload failed: ${errorText}`);
                    }
                    
                    const data = await response.json();
                    console.log('Upload successful:', data);
                    setJobId(data.job_id);
                    setVideoInfo(data.video_info);
                    setProcessing(false);
                    
                } catch (err) {
                    console.error('Upload error:', err);
                    setError('Failed to upload file: ' + err.message);
                    setProcessing(false);
                    setSelectedFile(null);
                }
            };
            
            const startProcessing = async () => {
                if (!jobId) return;
                
                try {
                    setProcessing(true);
                    setError(null);
                    
                    const response = await fetch(`/api/process/${jobId}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(settings)
                    });
                    
                    if (!response.ok) {
                        throw new Error('Failed to start processing');
                    }
                    
                    // Start polling for status
                    startStatusPolling();
                    
                } catch (err) {
                    setError('Failed to start processing: ' + err.message);
                    setProcessing(false);
                }
            };
            
            const startStatusPolling = () => {
                if (pollIntervalRef.current) {
                    clearInterval(pollIntervalRef.current);
                }
                
                pollIntervalRef.current = setInterval(async () => {
                    try {
                        const response = await fetch(`/api/status/${jobId}`);
                        if (!response.ok) throw new Error('Failed to get status');
                        
                        const status = await response.json();
                        setJobStatus(status);
                        
                        if (status.status === 'completed' || status.status === 'error') {
                            clearInterval(pollIntervalRef.current);
                            setProcessing(false);
                            
                            if (status.status === 'error') {
                                setError(status.error);
                            }
                        }
                    } catch (err) {
                        console.error('Polling error:', err);
                    }
                }, 1000);
            };
            
            const downloadResult = () => {
                if (jobId && jobStatus?.status === 'completed') {
                    window.location.href = `/api/download/${jobId}`;
                }
            };
            
            const cancelProcessing = async () => {
                if (!jobId) return;
                
                try {
                    const response = await fetch(`/api/cancel/${jobId}`, {
                        method: 'POST'
                    });
                    
                    if (response.ok) {
                        setProcessing(false);
                        if (pollIntervalRef.current) {
                            clearInterval(pollIntervalRef.current);
                        }
                        // Update status immediately
                        setJobStatus(prev => ({
                            ...prev,
                            status: 'cancelled',
                            message: 'Processing cancelled by user'
                        }));
                    } else {
                        throw new Error('Failed to cancel processing');
                    }
                } catch (err) {
                    setError('Failed to cancel: ' + err.message);
                }
            };
            
            const reset = () => {
                setSelectedFile(null);
                setJobId(null);
                setJobStatus(null);
                setProcessing(false);
                setError(null);
                setVideoInfo(null);
                if (pollIntervalRef.current) {
                    clearInterval(pollIntervalRef.current);
                }
            };
            
            const handleDragOver = (e) => {
                e.preventDefault();
                e.stopPropagation();
                e.currentTarget.classList.add('drag-over');
            };
            
            const handleDragLeave = (e) => {
                e.preventDefault();
                e.stopPropagation();
                e.currentTarget.classList.remove('drag-over');
            };
            
            const handleDrop = (e) => {
                e.preventDefault();
                e.stopPropagation();
                e.currentTarget.classList.remove('drag-over');
                
                const file = e.dataTransfer.files[0];
                if (file) {
                    handleFileSelect(file);
                }
            };
            
            return (
                <div className="min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 transition-colors duration-200">
                    {/* Header */}
                    <header className="bg-white dark:bg-gray-800 shadow-sm">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center space-x-3">
                                    <div className="w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center text-2xl">
                                        ‚ú®
                                    </div>
                                    <div>
                                        <h1 className="text-2xl font-bold text-gray-900 dark:text-white">
                                            Video Denoiser
                                        </h1>
                                        <p className="text-sm text-gray-500 dark:text-gray-400">
                                            AI-Powered NAFNet Denoising
                                        </p>
                                    </div>
                                </div>
                                
                                <button
                                    onClick={() => setDarkMode(!darkMode)}
                                    className="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"
                                >
                                    <span className="text-xl">{darkMode ? '‚òÄÔ∏è' : 'üåô'}</span>
                                </button>
                            </div>
                        </div>
                    </header>
                    
                    {/* Main Content */}
                    <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                        {error && (
                            <div className="mb-6 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 flex items-start space-x-3">
                                <span className="text-red-600 dark:text-red-400 flex-shrink-0 mt-0.5">‚ö†Ô∏è</span>
                                <div className="flex-1">
                                    <p className="text-sm text-red-800 dark:text-red-300">{error}</p>
                                </div>
                                <button onClick={() => setError(null)} className="text-red-600 dark:text-red-400 hover:text-red-800 dark:hover:text-red-200">
                                    <span className="text-lg">√ó</span>
                                </button>
                            </div>
                        )}
                        
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            {/* Upload Section */}
                            <div className="lg:col-span-2">
                                <div className="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                                    <h2 className="text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center space-x-2">
                                        <span>üì§</span>
                                        <span>Upload Video</span>
                                    </h2>
                                    
                                    {!selectedFile ? (
                                        <div
                                            onDragOver={handleDragOver}
                                            onDragLeave={handleDragLeave}
                                            onDrop={handleDrop}
                                            onClick={() => fileInputRef.current?.click()}
                                            className="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-12 text-center cursor-pointer hover:border-blue-500 dark:hover:border-blue-400 transition-colors"
                                        >
                                            <div className="text-6xl mb-4">üé¨</div>
                                            <p className="text-lg font-medium text-gray-700 dark:text-gray-300 mb-2">
                                                Drag & drop your video here
                                            </p>
                                            <p className="text-sm text-gray-500 dark:text-gray-400 mb-4">
                                                or click to browse
                                            </p>
                                            <p className="text-xs text-gray-400 dark:text-gray-500">
                                                Supports all video formats ‚Ä¢ Optimized for DJI drones
                                            </p>
                                            <input
                                                ref={fileInputRef}
                                                type="file"
                                                accept="video/*"
                                                onChange={(e) => handleFileSelect(e.target.files[0])}
                                                className="hidden"
                                            />
                                        </div>
                                    ) : (
                                        <div className="space-y-4">
                                            {/* Video Preview */}
                                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-4">
                                                {/* Original Video */}
                                                <div className="bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4">
                                                    <div className="flex items-center justify-between mb-3">
                                                        <h3 className="text-sm font-semibold text-gray-700 dark:text-gray-300">
                                                            üì• Original Video
                                                        </h3>
                                                        <button
                                                            onClick={reset}
                                                            className="p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 text-xs"
                                                        >
                                                            √ó
                                                        </button>
                                                    </div>
                                                    <div className="bg-black rounded-lg overflow-hidden mb-3">
                                                        <video
                                                            src={selectedFile ? URL.createObjectURL(selectedFile) : ''}
                                                            controls
                                                            className="w-full"
                                                            style={{maxHeight: '300px'}}
                                                        >
                                                            Your browser does not support the video tag.
                                                        </video>
                                                    </div>
                                                    <div>
                                                        <p className="font-medium text-gray-900 dark:text-white truncate text-sm">
                                                            {selectedFile.name}
                                                        </p>
                                                        <p className="text-xs text-gray-500 dark:text-gray-400">
                                                            {(selectedFile.size / 1024 / 1024).toFixed(2)} MB
                                                        </p>
                                                        {videoInfo && (
                                                            <div className="mt-2 flex flex-wrap gap-2">
                                                                {videoInfo.width && videoInfo.height && (
                                                                    <span className="inline-flex items-center px-2 py-1 rounded text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300">
                                                                        {videoInfo.width}x{videoInfo.height}
                                                                    </span>
                                                                )}
                                                                {videoInfo.fps && (
                                                                    <span className="inline-flex items-center px-2 py-1 rounded text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300">
                                                                        {Number(videoInfo.fps).toFixed(2)} fps
                                                                    </span>
                                                                )}
                                                                {videoInfo.codec && (
                                                                    <span className="inline-flex items-center px-2 py-1 rounded text-xs bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300">
                                                                        {videoInfo.codec}
                                                                    </span>
                                                                )}
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>
                                                
                                                {/* Denoised Video */}
                                                {jobStatus?.status === 'completed' && jobStatus?.output_file ? (
                                                    <div className="bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border-2 border-green-200 dark:border-green-800">
                                                        <h3 className="text-sm font-semibold text-green-700 dark:text-green-400 mb-3">
                                                            ‚ú® Denoised Video
                                                        </h3>
                                                        <div className="bg-black rounded-lg overflow-hidden mb-3">
                                                            <video
                                                                src={`/api/download/${jobId}`}
                                                                controls
                                                                className="w-full"
                                                                style={{maxHeight: '300px'}}
                                                            >
                                                                Your browser does not support the video tag.
                                                            </video>
                                                        </div>
                                                        <p className="text-xs text-green-700 dark:text-green-400">
                                                            ‚úì Processing complete
                                                        </p>
                                                    </div>
                                                ) : (
                                                    <div className="bg-gray-100 dark:bg-gray-700/30 rounded-lg p-4 border-2 border-dashed border-gray-300 dark:border-gray-600 flex items-center justify-center">
                                                        <div className="text-center">
                                                            <div className="text-4xl mb-2">‚è≥</div>
                                                            <p className="text-sm text-gray-500 dark:text-gray-400">
                                                                Denoised video will appear here
                                                            </p>
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                            
                                            {/* Progress */}
                                            {(processing || jobStatus) && (
                                                <div className="space-y-3">
                                                    <div className="flex items-center justify-between gap-3">
                                                        <div className="flex-1">
                                                            <div className="flex items-center justify-between text-sm mb-2">
                                                                <span className="font-medium text-gray-700 dark:text-gray-300">
                                                                    {jobStatus?.message || 'Starting processing...'}
                                                                </span>
                                                                <span className="text-gray-500 dark:text-gray-400">
                                                                    {jobStatus?.progress || 0}%
                                                                </span>
                                                            </div>
                                                            <div className="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden">
                                                                <div
                                                                    className="progress-bar h-full bg-gradient-to-r from-blue-500 to-purple-600 rounded-full transition-all"
                                                                    style={{ width: `${jobStatus?.progress || 0}%` }}
                                                                ></div>
                                                            </div>
                                                        </div>
                                                        {(processing || jobStatus?.status === 'processing') && (
                                                            <button
                                                                onClick={cancelProcessing}
                                                                className="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium transition-colors flex items-center space-x-1 text-sm flex-shrink-0"
                                                                title="Stop processing"
                                                            >
                                                                <span>‚èπ</span>
                                                                <span>Stop</span>
                                                            </button>
                                                        )}
                                                    </div>
                                                </div>
                                            )}
                                            
                                            {/* Actions */}
                                            <div className="flex gap-3">
                                                {!processing && !jobStatus ? (
                                                    <button
                                                        onClick={startProcessing}
                                                        className="flex-1 bg-gradient-to-r from-blue-500 to-purple-600 text-white px-6 py-3 rounded-lg font-medium hover:from-blue-600 hover:to-purple-700 transition-all flex items-center justify-center space-x-2"
                                                    >
                                                        <span>‚ñ∂Ô∏è</span>
                                                        <span>Start Denoising</span>
                                                    </button>
                                                ) : jobStatus?.status === 'completed' ? (
                                                    <>
                                                        <button
                                                            onClick={downloadResult}
                                                            className="flex-1 bg-gradient-to-r from-green-500 to-emerald-600 text-white px-6 py-3 rounded-lg font-medium hover:from-green-600 hover:to-emerald-700 transition-all flex items-center justify-center space-x-2"
                                                        >
                                                            <span>‚¨áÔ∏è</span>
                                                            <span>Download Result</span>
                                                        </button>
                                                        <button
                                                            onClick={reset}
                                                            className="px-6 py-3 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg font-medium hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"
                                                        >
                                                            New Video
                                                        </button>
                                                    </>
                                                ) : (
                                                    <button
                                                        disabled
                                                        className="flex-1 bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 px-6 py-3 rounded-lg font-medium cursor-not-allowed flex items-center justify-center space-x-2"
                                                    >
                                                        <div className="animate-spin rounded-full h-5 w-5 border-2 border-gray-500 border-t-transparent"></div>
                                                        <span>Processing...</span>
                                                    </button>
                                                )}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </div>
                            
                            {/* Settings Panel */}
                            <div className="space-y-6">
                                {/* Settings */}
                                <div className="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6">
                                    <h2 className="text-xl font-semibold text-gray-900 dark:text-white mb-4 flex items-center space-x-2">
                                        <span>‚öôÔ∏è</span>
                                        <span>Settings</span>
                                    </h2>
                                    
                                    <div className="space-y-4">
                                        {/* Model Selection */}
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                                AI Model
                                            </label>
                                            <div className="space-y-2">
                                                {Object.entries(availableModels).filter(([_, info]) => info.downloaded).map(([name, info]) => (
                                                    <label key={name} className="flex items-center space-x-2 cursor-pointer">
                                                        <input
                                                            type="radio"
                                                            name="modelName"
                                                            value={name}
                                                            checked={settings.modelName === name}
                                                            onChange={(e) => setSettings({...settings, modelName: name})}
                                                            className="w-4 h-4 text-blue-600 focus:ring-2 focus:ring-blue-500"
                                                            disabled={processing}
                                                        />
                                                        <span className="text-sm text-gray-700 dark:text-gray-300">
                                                            {info.description}
                                                        </span>
                                                    </label>
                                                ))}
                                            </div>
                                            <p className="mt-1 text-xs text-gray-500 dark:text-gray-400">
                                                Select downloaded model to use for denoising
                                            </p>
                                        </div>
                                        
                                        {/* NAFNet Passes */}
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                                Denoising Strength
                                            </label>
                                            <div className="space-y-2">
                                                <label className="flex items-center space-x-2 cursor-pointer">
                                                    <input
                                                        type="radio"
                                                        name="numPasses"
                                                        value="1"
                                                        checked={settings.numPasses === 1}
                                                        onChange={(e) => setSettings({...settings, numPasses: 1})}
                                                        className="w-4 h-4 text-blue-600 focus:ring-2 focus:ring-blue-500"
                                                        disabled={processing}
                                                    />
                                                    <span className="text-sm text-gray-700 dark:text-gray-300">Light (1 pass) - Fast</span>
                                                </label>
                                                <label className="flex items-center space-x-2 cursor-pointer">
                                                    <input
                                                        type="radio"
                                                        name="numPasses"
                                                        value="2"
                                                        checked={settings.numPasses === 2}
                                                        onChange={(e) => setSettings({...settings, numPasses: 2})}
                                                        className="w-4 h-4 text-blue-600 focus:ring-2 focus:ring-blue-500"
                                                        disabled={processing}
                                                    />
                                                    <span className="text-sm text-gray-700 dark:text-gray-300">Medium (2 passes) - Recommended ‚≠ê</span>
                                                </label>
                                                <label className="flex items-center space-x-2 cursor-pointer">
                                                    <input
                                                        type="radio"
                                                        name="numPasses"
                                                        value="3"
                                                        checked={settings.numPasses === 3}
                                                        onChange={(e) => setSettings({...settings, numPasses: 3})}
                                                        className="w-4 h-4 text-blue-600 focus:ring-2 focus:ring-blue-500"
                                                        disabled={processing}
                                                    />
                                                    <span className="text-sm text-gray-700 dark:text-gray-300">Strong (3 passes) - Best Quality</span>
                                                </label>
                                            </div>
                                            <p className="mt-1 text-xs text-gray-500 dark:text-gray-400">
                                                More passes = stronger denoising but slower
                                            </p>
                                        </div>
                                        
                                        {/* Max Quality */}
                                        <div>
                                            <label className="flex items-center space-x-2 cursor-pointer">
                                                <input
                                                    type="checkbox"
                                                    checked={settings.useTemporal}
                                                    onChange={(e) => setSettings({...settings, useTemporal: e.target.checked})}
                                                    className="w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"
                                                    disabled={processing}
                                                />
                                                <span className="text-sm font-medium text-gray-700 dark:text-gray-300">
                                                    Max Quality (Temporal Enhancement)
                                                </span>
                                            </label>
                                            <p className="mt-1 text-xs text-gray-500 dark:text-gray-400">
                                                Averages neighboring frames for smoother results
                                            </p>
                                        </div>
                                        
                                        {/* Clip Size */}
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                                Clip Size
                                            </label>
                                            <input
                                                type="number"
                                                min="1"
                                                max="10"
                                                value={settings.clipSize}
                                                onChange={(e) => setSettings({...settings, clipSize: parseInt(e.target.value)})}
                                                className="w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                                disabled={processing}
                                            />
                                            <p className="mt-1 text-xs text-gray-500 dark:text-gray-400">
                                                Number of frames to process together (2-5 recommended)
                                            </p>
                                        </div>
                                        
                                    </div>
                                </div>
                                
                                {/* Info */}
                                <div className="bg-blue-50 dark:bg-blue-900/20 rounded-xl p-6 border border-blue-200 dark:border-blue-800">
                                    <div className="flex items-start space-x-3">
                                        <span className="text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5">‚ÑπÔ∏è</span>
                                        <div className="text-sm text-blue-800 dark:text-blue-300">
                                            <p className="font-medium mb-2">About NAFNet Denoising</p>
                                            <ul className="space-y-1 text-xs">
                                                <li>‚Ä¢ State-of-the-art AI denoising (ECCV 2022)</li>
                                                <li>‚Ä¢ Trained on real-world smartphone noise</li>
                                                <li>‚Ä¢ Multiple passes for stronger effect</li>
                                                <li>‚Ä¢ Temporal enhancement for smooth video</li>
                                                <li>‚Ä¢ Preserves audio and metadata</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </main>
                    
                    {/* Footer */}
                    <footer className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 mt-12">
                        <div className="text-center text-sm text-gray-500 dark:text-gray-400">
                            <p>Powered by NAFNet (ECCV 2022) ‚Ä¢ Running locally on your GPU</p>
                        </div>
                    </footer>
                </div>
            );
        }
        
        // Render App with Error Boundary
        ReactDOM.render(
            <ErrorBoundary>
                <App />
            </ErrorBoundary>,
            document.getElementById('root')
        );
    </script>
</body>
</html>
